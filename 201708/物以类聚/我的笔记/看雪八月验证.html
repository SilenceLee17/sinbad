<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><meta name="exporter-version" content="Evernote Mac 6.11.1 (455061)"/><meta name="author" content="184251289@qq.com"/><meta name="created" content="2017-08-05 16:16:33 +0000"/><meta name="source" content="desktop.mac"/><meta name="updated" content="2017-08-17 02:57:32 +0000"/><title>看雪八月验证</title></head><body><div/><div><span style="color: rgb(51, 51, 51); font-size: 14px; font-variant-caps: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-family: Arial;">一、</span><span style="color: rgb(51, 51, 51); font-size: 14px; font-variant-caps: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-family: Arial;">FSEvent日志位置</span></div><div><span style="color: rgb(51, 51, 51); font-size: 14px; font-variant-caps: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-family: Arial;">OS X的</span><span style="color: rgb(51, 51, 51); font-size: 14px; font-variant-caps: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-family: Arial;">日志</span><span style="color: rgb(51, 51, 51); font-size: 14px; font-variant-caps: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-family: Arial;">位置</span></div><div><span style="font-family: Arial; color: rgb(51, 51, 51);">cd</span></div><div><span style="font-family: Arial; color: rgb(51, 51, 51);">cd ../..</span></div><div><span style="font-family: Arial; color: rgb(51, 51, 51);">pwd</span></div><div><br/></div><div>/</div><div><br/></div><div>ll -a</div><div><br/></div><div>d-wx-wx-wt     2 root  wheel    68B  3 17  2015 .Trashes</div><div>----------     1 root  admin     0B  2 21 11:38 .file</div><div>drwx------  2879 root  wheel    96K  8  6 00:15 .fseventsd</div><div>drwxr-xr-x@    2 root  wheel    68B  3 11 22:19 .vol</div><div><br/></div><div><br/></div><div>cd .fseventsd</div><div>cd: permission denied: .fseventsd</div><div><br/></div><div><img src="%E7%9C%8B%E9%9B%AA%E5%85%AB%E6%9C%88%E9%AA%8C%E8%AF%81.resources/6B5963E2-D64F-47E5-8A41-26DCD7D1A90B.png" height="502" width="658"/><br/></div><div><br/></div><div><span style="color: rgb(34, 34, 34); font-size: 18px; font-variant-caps: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-weight: bold; font-family: 'Yanone Kaffeesatz'; text-rendering: optimizelegibility;">iOS中的位置</span></div><div><br/></div><div style="color: rgb(51, 51, 51); font-size: 14px; font-variant-caps: normal; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; word-spacing: 0px; -webkit-text-stroke-width: 0px; -en-paragraph: true; margin-top: 1em; margin-bottom: 1em;"><span style="color: rgb(51, 51, 51); font-size: 14px; font-variant-caps: normal; letter-spacing: normal; text-indent: 0px; text-transform: none; white-space: normal; word-spacing: 0px; -webkit-text-stroke-width: 0px; -en-paragraph: true; margin-top: 1em; margin-bottom: 1em; orphans: auto; widows: auto; font-weight: bold; font-family: Arial, Helvetica, sans-serif; text-rendering: optimizelegibility;">1) </span><span style="color: rgb(51, 51, 51); font-size: 14px; font-variant-caps: normal; letter-spacing: normal; text-indent: 0px; text-transform: none; white-space: normal; word-spacing: 0px; -webkit-text-stroke-width: 0px; -en-paragraph: true; margin-top: 1em; margin-bottom: 1em; orphans: auto; widows: auto; font-weight: bold; font-family: Arial, Helvetica, sans-serif; text-rendering: optimizelegibility;">System: </span><span style="color: rgb(51, 51, 51); font-size: 14px; font-variant-caps: normal; letter-spacing: normal; text-indent: 0px; text-transform: none; white-space: normal; word-spacing: 0px; -webkit-text-stroke-width: 0px; -en-paragraph: true; margin-top: 1em; margin-bottom: 1em; orphans: auto; widows: auto; font-weight: bold; font-family: Arial, Helvetica, sans-serif; text-rendering: optimizelegibility;">/.fseventsd’</span></div><div style="color: rgb(51, 51, 51); font-size: 14px; font-variant-caps: normal; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-family: Arial, Helvetica, sans-serif; -en-paragraph: true; margin-top: 1em; margin-bottom: 1em;"><span style="color: rgb(51, 51, 51); font-size: 14px; font-variant-caps: normal; letter-spacing: normal; text-indent: 0px; text-transform: none; white-space: normal; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-family: Arial, Helvetica, sans-serif; -en-paragraph: true; margin-top: 1em; margin-bottom: 1em; orphans: auto; widows: auto; font-weight: bold; text-rendering: optimizelegibility;">2) </span><span style="color: rgb(51, 51, 51); font-size: 14px; font-variant-caps: normal; letter-spacing: normal; text-indent: 0px; text-transform: none; white-space: normal; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-family: Arial, Helvetica, sans-serif; -en-paragraph: true; margin-top: 1em; margin-bottom: 1em; orphans: auto; widows: auto; font-weight: bold; text-rendering: optimizelegibility;">Data: </span><span style="color: rgb(51, 51, 51); font-size: 14px; font-variant-caps: normal; letter-spacing: normal; text-indent: 0px; text-transform: none; white-space: normal; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-family: Arial, Helvetica, sans-serif; -en-paragraph: true; margin-top: 1em; margin-bottom: 1em; orphans: auto; widows: auto; font-weight: bold; text-rendering: optimizelegibility;">/private/var/.fseventsd’</span></div><div style="color: rgb(51, 51, 51); font-size: 14px; font-variant-caps: normal; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-family: Arial, Helvetica, sans-serif; -en-paragraph: true; margin-top: 1em; margin-bottom: 1em;"><br/></div><div><br/></div><div><img src="%E7%9C%8B%E9%9B%AA%E5%85%AB%E6%9C%88%E9%AA%8C%E8%AF%81.resources/C75DF92C-6678-46F0-9CC6-8484DDF73050.png" height="358" width="714"/><br/></div><div><br/></div><div><img src="%E7%9C%8B%E9%9B%AA%E5%85%AB%E6%9C%88%E9%AA%8C%E8%AF%81.resources/A7B0AB41-061F-45BB-B1AD-482E648E88DD.png" height="978" width="620"/><br/></div><div><br/></div><div><span style="color: rgb(51, 51, 51); font-size: 14px; font-variant-caps: normal; letter-spacing: normal; text-indent: 0px; text-transform: none; white-space: normal; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-family: Arial, Helvetica, sans-serif; -en-paragraph: true; margin-top: 1em; margin-bottom: 1em; orphans: auto; widows: auto; font-weight: bold;">Developer Patch:</span><span style="color: rgb(51, 51, 51); font-size: 14px; font-variant-caps: normal; letter-spacing: normal; text-indent: 0px; text-transform: none; white-space: normal; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-family: Arial, Helvetica, sans-serif; -en-paragraph: true; margin-top: 1em; margin-bottom: 1em; orphans: auto; widows: auto;">/DeveloperPatch/.fseventsd’未找到</span></div><div><br/></div><div><br/></div><div><span style="color: rgb(51, 51, 51); font-size: 14px; font-variant-caps: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px;">外部设备位置</span></div><div><img src="%E7%9C%8B%E9%9B%AA%E5%85%AB%E6%9C%88%E9%AA%8C%E8%AF%81.resources/B81C8994-65C3-4CE8-B39E-8495A651365E.png" height="300" width="422"/><br/></div><hr/><div><br/></div><div><br/></div><div>fseventsd-uuid文件</div><div><br/></div><div><span style="padding: 0px 0px 5px; font-size: 13px; color: rgb(0, 0, 0); font-family: Tahoma, Arial, Helvetica, sans-serif; font-variant-caps: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px; font-weight: bold;">fseventsd-uuid files</span><span style="padding: 0px 0px 5px; font-size: 13px; color: rgb(0, 0, 0); font-family: Tahoma, Arial, Helvetica, sans-serif; font-variant-caps: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px;"> are generated on external media (like USB flash disk) connected to Linux or Mac OS X (macOS) computers. If the media is disconnected without the safe ejection procedure, or because the computer shuts down from low battery, one or more such files are generated on the media.</span></div><div style="padding: 0px 0px 5px; font-size: 13px; color: rgb(0, 0, 0); font-family: Tahoma, Arial, Helvetica, sans-serif; font-variant-caps: normal; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; word-spacing: 0px; -webkit-text-stroke-width: 0px; -en-paragraph: true; margin-top: 1em; margin-bottom: 1em;"><span style="padding: 0px 0px 5px; font-size: 13px; color: rgb(0, 0, 0); font-family: Tahoma, Arial, Helvetica, sans-serif; font-variant-caps: normal; letter-spacing: normal; text-indent: 0px; text-transform: none; white-space: normal; word-spacing: 0px; -webkit-text-stroke-width: 0px; -en-paragraph: true; margin-top: 1em; margin-bottom: 1em; orphans: auto; widows: auto; -webkit-text-size-adjust: auto;">Sometimes the </span><span style="padding: 0px 0px 5px; font-size: 13px; color: rgb(0, 0, 0); font-family: Tahoma, Arial, Helvetica, sans-serif; font-variant-caps: normal; letter-spacing: normal; text-indent: 0px; text-transform: none; white-space: normal; word-spacing: 0px; -webkit-text-stroke-width: 0px; -en-paragraph: true; margin-top: 1em; margin-bottom: 1em; orphans: auto; widows: auto; -webkit-text-size-adjust: auto; font-weight: bold;">fseventsd-uuid file</span><span style="padding: 0px 0px 5px; font-size: 13px; color: rgb(0, 0, 0); font-family: Tahoma, Arial, Helvetica, sans-serif; font-variant-caps: normal; letter-spacing: normal; text-indent: 0px; text-transform: none; white-space: normal; word-spacing: 0px; -webkit-text-stroke-width: 0px; -en-paragraph: true; margin-top: 1em; margin-bottom: 1em; orphans: auto; widows: auto; -webkit-text-size-adjust: auto;"> is produced by Microsoft Windows installed in Parallels Desktop on Mac, or Windows installed in the Bootcamp and it is not able to delete by user in OS X.</span></div><div><span style="padding: 0px 0px 5px; font-size: 13px; color: rgb(0, 0, 0); font-family: Tahoma, Arial, Helvetica, sans-serif; font-variant-caps: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px;">You need to run emulated Windows and delete fseventsd-uuid files with </span><span style="padding: 0px 0px 5px; font-size: 13px; color: rgb(0, 0, 0); font-family: Tahoma, Arial, Helvetica, sans-serif; font-variant-caps: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px; font-style: italic;">chkdsk </span><span style="padding: 0px 0px 5px; font-size: 13px; color: rgb(0, 0, 0); font-family: Tahoma, Arial, Helvetica, sans-serif; font-variant-caps: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px;">command line tool.</span></div><hr/><div><span style="color: rgb(51, 51, 51); font-size: 14px; font-variant-caps: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px;">FSEvent日志文件</span></div><div><br/></div><div>0000000000a1b268</div><div>值为10596965</div><div><br/></div><div><span style="color: rgb(51, 51, 51); font-size: 14px; font-variant-caps: normal; letter-spacing: normal; text-indent: 0px; text-transform: none; white-space: normal; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-family: Arial; -en-paragraph: true; margin-top: 1em; margin-bottom: 1em; orphans: auto; widows: auto;">最后一个事件ID</span><span style="color: rgb(51, 51, 51); font-size: 14px; font-variant-caps: normal; letter-spacing: normal; text-indent: 0px; text-transform: none; white-space: normal; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-family: Arial; -en-paragraph: true; margin-top: 1em; margin-bottom: 1em; orphans: auto; widows: auto;">10596964</span></div><div><br/></div><div><img src="%E7%9C%8B%E9%9B%AA%E5%85%AB%E6%9C%88%E9%AA%8C%E8%AF%81.resources/B6A18921-169F-4153-9150-C4410F4D7656.png" height="186" width="798"/><br/></div><div><br/></div><div><br/></div><hr/><div><span style="color: rgb(51, 51, 51); font-size: 14px; font-variant-caps: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px;">FSEvent日志格式</span></div><div><br/></div><div>重命名0000000000a1b268为0000000000a1b268.zip。解压缩</div><div><br/></div><div>拖入ihex中</div><div><br/></div><div><img src="%E7%9C%8B%E9%9B%AA%E5%85%AB%E6%9C%88%E9%AA%8C%E8%AF%81.resources/B879940C-C60E-4A4F-980C-EE2EA6656E81.png" height="304" width="1088"/><br/></div><div><br/></div><hr/><div><br/></div><div><span style="color: rgb(51, 51, 51); font-size: 14px; font-variant-caps: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px;">FSEvent记录组件</span></div><div><br/></div><div><br/></div><div>                                  offset length      </div><div>page magic number  0x00   0x04     1SLD   0x31534C44</div><div>page unknown value 0x04   0x04     0x140D643C(336421948)</div><div>page size                   0x08   0x04     0x0003fff3(262131)        0xF3FF0300（高低位）</div><div>record full path          0x0c   0x23 variable Applications/Pages.app/Contents/SharedSupport/DocumentResources   </div><div><br/></div><div>null terminator          0x3b   0x01       0x00  <span style="color: rgb(51, 51, 51); font-size: 14px; font-variant-caps: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-family: Arial, Helvetica, sans-serif;">完整路径终止符</span></div><div>record event id         0x3c   0x08       0xa17c91(10583185)         0x917ca10000000000（高低位）</div><div>record reason flags  0x44   0x04       0x04000001   Inode Metadata Modified    Item is Folder</div><div><br/></div><div><br/></div><div><br/></div><div>验证了多页眉以及上一个page  size</div><div><br/></div><div><img src="%E7%9C%8B%E9%9B%AA%E5%85%AB%E6%9C%88%E9%AA%8C%E8%AF%81.resources/E5C7C748-EF9B-412D-9648-2AD0AA02C101.png" height="652" width="972"/><br/></div><div><br/></div><div><br/></div><hr/><div><br/></div><div>FSEvent记录标志</div><div><br/></div><div>record reason flags  0x44   0x04       0x04000001   Inode Metadata Modified    Item is Folder</div><div><br/></div><div><br/></div><div>FSEventsParser解析结果</div><div><img src="%E7%9C%8B%E9%9B%AA%E5%85%AB%E6%9C%88%E9%AA%8C%E8%AF%81.resources/68E7BDBB-909B-4092-986F-AD3EEA4AF755.png" height="160" width="1436"/><br/></div><hr/><div><br/></div><div>FSEventsParser解析</div><div><br/></div><div>git clone <a href="https://github.com/dlcowen/FSEventsParser">https://github.com/dlcowen/FSEventsParser</a></div><div><br/></div><div>cd FSEventsParser</div><div><br/></div><div>chmod 777 FSEParser_V2.1.py</div><div><br/></div><div>vi FSEParser_V2.1.py</div><div><span style="color: rgb(0, 0, 0); font-family: Monaco, 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', Consolas, 'Courier New', monospace; font-size: 12px; font-variant-caps: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px; background-color: rgb(250, 250, 250); float: none;">:set ff=unix</span></div><div><span style="color: rgb(0, 0, 0); font-family: Monaco, 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', Consolas, 'Courier New', monospace; font-size: 12px; font-variant-caps: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px; background-color: rgb(250, 250, 250); float: none;">:wq</span></div><div><br/></div><div><br/></div><div>tips:第一个参数6位，源地址，输出地址</div><div><br/></div><div><br/></div><div>./FSEParser_v2.1.py -c 000001 -s /Users/lixingdong/Desktop/看雪/fsevent -o /Users/lixingdong/Desktop/看雪/result</div><div><br/></div><div>File 1 of 3:     Trying    .DS_Store</div><div><br/></div><div>File 2 of 3:     Trying    .fseventsd</div><div><br/></div><div>File 3 of 3:     Trying    0000000000a1b268</div><div>SLD Header found. Parsing records</div><div>SLD Header found. Parsing records</div><div>SLD Header found. Parsing records</div><div>SLD Header found. Parsing records</div><div>SLD Header found. Parsing records</div><div><br/></div><div>---------------------</div><div><br/></div><div>FINISHED PARSING: See exceptions log for parsing errors.</div><div>All Files Attempted: 3</div><div>All Parsed Files: 1</div><div>Files with Errors: 2</div><div>All Records Parsed: 5000</div><div><br/></div><div><br/></div><div>cd /Users/lixingdong/Desktop/看雪/result</div><div>ls</div><div><br/></div><div>000001_FSEvents-EXCEPTIONS_LOG.txt</div><div>000001_FSEvents-Parsed_Records.tsv</div><div>000001_FSEvents-Parsed_Records_DB.sqlite</div><div><br/></div><div><br/></div><hr/><div><br/></div><div><span style="color: rgb(34, 34, 34); font-size: 18px; font-variant-caps: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-weight: bold; font-family: 'Yanone Kaffeesatz'; text-rendering: optimizelegibility;">废纸篓活动</span></div><div><br/></div><div><span style="color: rgb(34, 34, 34); font-size: 18px; font-variant-caps: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-weight: bold; font-family: 'Yanone Kaffeesatz'; text-rendering: optimizelegibility;">SELECT</span></div><div><span style="font-size: 18px; color: rgb(34, 34, 34); font-family: 'Yanone Kaffeesatz'; font-weight: bold;">*, _ROWID_ "NAVICAT_ROWID"</span></div><div><span style="font-size: 18px; color: rgb(34, 34, 34); font-family: 'Yanone Kaffeesatz'; font-weight: bold;">FROM</span></div><div><span style="font-size: 18px; color: rgb(34, 34, 34); font-family: 'Yanone Kaffeesatz'; font-weight: bold;">"fsevents"</span></div><div><span style="font-size: 18px; color: rgb(34, 34, 34); font-family: 'Yanone Kaffeesatz'; font-weight: bold;">WHERE</span></div><div><span style="font-size: 18px; color: rgb(34, 34, 34); font-family: 'Yanone Kaffeesatz'; font-weight: bold;">"filename" LIKE 'Users/%/.Trash/%</span><span style="orphans: auto; text-indent: 0px; widows: auto; text-rendering: optimizelegibility; font-family: 'Yanone Kaffeesatz'; color: rgb(34, 34, 34); font-size: 18px; font-weight: bold;">’</span></div><div><br/></div><div><span style="font-size: 18px; color: rgb(51, 51, 51); font-family: Arial; font-weight: bold;">“重命名”掩码</span></div><div><br/></div><div><img src="%E7%9C%8B%E9%9B%AA%E5%85%AB%E6%9C%88%E9%AA%8C%E8%AF%81.resources/F95AE88D-5B20-4CB1-A72C-413E8E64BD3E.png" height="1044" width="1332"/><br/></div><div><br/></div><hr/><div><span style="font-weight: bold; font-family: 'Yanone Kaffeesatz'; font-size: 18px; color: rgb(34, 34, 34);">系统启动</span></div><div><br/></div><div><span style="font-weight: bold; font-family: 'Yanone Kaffeesatz'; font-size: 18px; color: rgb(34, 34, 34);">SELECT</span></div><div><span style="font-size: 18px; color: rgb(34, 34, 34); font-family: 'Yanone Kaffeesatz'; font-weight: bold;">*, _ROWID_ "NAVICAT_ROWID"</span></div><div><span style="font-size: 18px; color: rgb(34, 34, 34); font-family: 'Yanone Kaffeesatz'; font-weight: bold;">FROM</span></div><div><span style="font-size: 18px; color: rgb(34, 34, 34); font-family: 'Yanone Kaffeesatz'; font-weight: bold;">"fsevents"</span></div><div><span style="font-size: 18px; color: rgb(34, 34, 34); font-family: 'Yanone Kaffeesatz'; font-weight: bold;">WHERE</span></div><div><span style="font-size: 18px; color: rgb(34, 34, 34); font-family: 'Yanone Kaffeesatz'; font-weight: bold;">(</span></div><div><span style="font-size: 18px; color: rgb(34, 34, 34); font-family: 'Yanone Kaffeesatz'; font-weight: bold;">"filename" = '/home'</span></div><div><span style="font-size: 18px; color: rgb(34, 34, 34); font-family: 'Yanone Kaffeesatz'; font-weight: bold;">OR "filename" = '/net'</span></div><div><span style="font-size: 18px; color: rgb(34, 34, 34); font-family: 'Yanone Kaffeesatz'; font-weight: bold;">)</span></div><div><span style="font-size: 18px; color: rgb(34, 34, 34); font-family: 'Yanone Kaffeesatz'; font-weight: bold;">AND "mask" LIKE '%mount%</span><span style="font-family: 'Yanone Kaffeesatz'; color: rgb(34, 34, 34); font-size: 18px; font-weight: bold;">’</span></div><div><br/></div><div><img src="%E7%9C%8B%E9%9B%AA%E5%85%AB%E6%9C%88%E9%AA%8C%E8%AF%81.resources/841C7FDD-3AC9-4174-9067-9D01EA3835A5.png" height="826" width="1376"/><br/></div><div><br/></div><hr/><div><span style="font-weight: bold; font-family: 'Yanone Kaffeesatz'; font-size: 18px; color: rgb(34, 34, 34);">用户个人资料文件夹</span></div><div><br/></div><div>SELECT</div><div>*, _ROWID_ "NAVICAT_ROWID"</div><div>FROM</div><div>"fsevents"</div><div>WHERE</div><div>(</div><div>"filename" LIKE 'Users/%/Documents/%'</div><div>OR "filename" LIKE 'Users/%/Downloads/%'</div><div>OR "filename" LIKE 'Users/%/Desktop/%'</div><div>)</div><div>AND "filename" NOT LIKE 'Users/%/Library/Caches/com.%'</div><div>AND "filename" NOT LIKE 'Users/%/Library/Containers/com.%'</div><div>AND "filename" NOT LIKE 'Users/%/Documents/Microsoft User Data/Office %’</div><div><br/></div><div><br/></div><div><img src="%E7%9C%8B%E9%9B%AA%E5%85%AB%E6%9C%88%E9%AA%8C%E8%AF%81.resources/843810F9-833B-4DE0-BA8A-75297D95F0D6.png" height="1102" width="1356"/><br/></div><div><br/></div><hr/><div><br/></div><div><span style="font-weight: bold; font-family: 'Yanone Kaffeesatz'; font-size: 18px; color: rgb(34, 34, 34);">安装的卷</span></div><div><br/></div><div><span style="font-family: 'Yanone Kaffeesatz'; color: rgb(34, 34, 34); font-size: 18px; font-weight: bold;">SELECT</span></div><div><span style="font-size: 18px; color: rgb(34, 34, 34); font-family: 'Yanone Kaffeesatz'; font-weight: bold;">*, _ROWID_ "NAVICAT_ROWID"</span></div><div><span style="font-size: 18px; color: rgb(34, 34, 34); font-family: 'Yanone Kaffeesatz'; font-weight: bold;">FROM</span></div><div><span style="font-size: 18px; color: rgb(34, 34, 34); font-family: 'Yanone Kaffeesatz'; font-weight: bold;">"fsevents"</span></div><div><span style="font-size: 18px; color: rgb(34, 34, 34); font-family: 'Yanone Kaffeesatz'; font-weight: bold;">WHERE</span></div><div><span style="font-size: 18px; color: rgb(34, 34, 34); font-family: 'Yanone Kaffeesatz'; font-weight: bold;">"mask" LIKE '%mount%'</span></div><div><span style="font-size: 18px; color: rgb(34, 34, 34); font-family: 'Yanone Kaffeesatz'; font-weight: bold;">AND "filename" NOT LIKE '/net'</span></div><div><span style="font-size: 18px; color: rgb(34, 34, 34); font-family: 'Yanone Kaffeesatz'; font-weight: bold;">AND "filename" NOT LIKE '/home</span><span style="font-family: 'Yanone Kaffeesatz'; color: rgb(34, 34, 34); font-weight: bold; font-size: 18px;">’</span></div><div><br/></div><div><img src="%E7%9C%8B%E9%9B%AA%E5%85%AB%E6%9C%88%E9%AA%8C%E8%AF%81.resources/6A7AEE26-0429-4EBD-AC1B-0CAC29549EA5.png" height="1088" width="1352"/><br/></div><div><br/></div><hr/><div><span style="font-weight: bold; font-family: 'Yanone Kaffeesatz'; font-size: 18px; color: rgb(34, 34, 34);">互联网活动</span></div><div><br/></div><div>SELECT</div><div>*, _ROWID_ "NAVICAT_ROWID"</div><div>FROM</div><div>"fsevents"</div><div>WHERE</div><div>"filename" LIKE 'Users/%/Library/Caches/Metadata/Safari/History/%'</div><div>OR "filename" LIKE 'Users/%/Library/Application Support/Google/Chrome/Default/Local Storage/%'</div><div>OR "filename" LIKE 'Users/%/Library/Safari/LocalStorage/%’</div><div><br/></div><div><br/></div><div><img src="%E7%9C%8B%E9%9B%AA%E5%85%AB%E6%9C%88%E9%AA%8C%E8%AF%81.resources/85510BE4-5D04-4F12-A470-7F9BF957219D.png" height="1084" width="1358"/><br/></div><div><br/></div><div><br/></div><hr/><div><br/></div><div><span style="font-weight: bold; font-family: 'Yanone Kaffeesatz'; font-size: 20px; color: rgb(34, 34, 34);">iOS事件</span></div><div><span style="font-family: 'Yanone Kaffeesatz'; color: rgb(34, 34, 34); font-size: 18px; font-weight: bold;">iCloud同步文件</span></div><div><br/></div><div><span style="font-family: 'Yanone Kaffeesatz'; color: rgb(34, 34, 34); font-size: 18px; font-weight: bold;">SELECT</span></div><div><span style="font-size: 18px; color: rgb(34, 34, 34); font-family: 'Yanone Kaffeesatz'; font-weight: bold;">*, _ROWID_ "NAVICAT_ROWID"</span></div><div><span style="font-size: 18px; color: rgb(34, 34, 34); font-family: 'Yanone Kaffeesatz'; font-weight: bold;">FROM</span></div><div><span style="font-size: 18px; color: rgb(34, 34, 34); font-family: 'Yanone Kaffeesatz'; font-weight: bold;">"fsevents"</span></div><div><span style="font-size: 18px; color: rgb(34, 34, 34); font-family: 'Yanone Kaffeesatz'; font-weight: bold;">WHERE</span></div><div><span style="font-size: 18px; color: rgb(34, 34, 34); font-family: 'Yanone Kaffeesatz'; font-weight: bold;">"filename" LIKE 'mobile/Library/Mobile Documents/com~apple~CloudDocs/%</span><span style="font-family: 'Yanone Kaffeesatz'; color: rgb(34, 34, 34); font-weight: bold; font-size: 18px;">’</span></div><div><br/></div><div><span style="font-size: 18px; color: rgb(34, 34, 34); font-family: 'Yanone Kaffeesatz'; font-weight: bold;">暂无</span></div><div><br/></div><div><span style="font-family: 'Yanone Kaffeesatz'; color: rgb(34, 34, 34); font-size: 18px; font-weight: bold;">互联网活动</span></div><div><br/></div><div><span style="font-family: 'Yanone Kaffeesatz'; color: rgb(34, 34, 34); font-weight: bold; font-size: 18px;">SELECT</span></div><div><span style="font-size: 18px; color: rgb(34, 34, 34); font-family: 'Yanone Kaffeesatz'; font-weight: bold;">*, _ROWID_ "NAVICAT_ROWID"</span></div><div><span style="font-size: 18px; color: rgb(34, 34, 34); font-family: 'Yanone Kaffeesatz'; font-weight: bold;">FROM</span></div><div><span style="font-size: 18px; color: rgb(34, 34, 34); font-family: 'Yanone Kaffeesatz'; font-weight: bold;">"fsevents"</span></div><div><span style="font-size: 18px; color: rgb(34, 34, 34); font-family: 'Yanone Kaffeesatz'; font-weight: bold;">WHERE</span></div><div><span style="font-size: 18px; color: rgb(34, 34, 34); font-family: 'Yanone Kaffeesatz'; font-weight: bold;">"filename" LIKE '%websitedata/local%’</span></div><div><br/></div><div><img src="%E7%9C%8B%E9%9B%AA%E5%85%AB%E6%9C%88%E9%AA%8C%E8%AF%81.resources/1C74092D-C2F0-4C06-B941-D3A9820EFAF4.png" height="1062" width="2296"/><br/></div><div><br/></div><div><span style="font-family: 'Yanone Kaffeesatz'; color: rgb(34, 34, 34); font-size: 18px; font-weight: bold;">电子邮件活动</span></div><div><br/></div><div><span style="font-family: 'Yanone Kaffeesatz'; color: rgb(34, 34, 34); font-size: 18px; font-weight: bold;">SELECT</span></div><div><span style="font-size: 18px; color: rgb(34, 34, 34); font-family: 'Yanone Kaffeesatz'; font-weight: bold;">*, _ROWID_ "NAVICAT_ROWID"</span></div><div><span style="font-size: 18px; color: rgb(34, 34, 34); font-family: 'Yanone Kaffeesatz'; font-weight: bold;">FROM</span></div><div><span style="font-size: 18px; color: rgb(34, 34, 34); font-family: 'Yanone Kaffeesatz'; font-weight: bold;">"fsevents"</span></div><div><span style="font-size: 18px; color: rgb(34, 34, 34); font-family: 'Yanone Kaffeesatz'; font-weight: bold;">WHERE</span></div><div><span style="font-size: 18px; color: rgb(34, 34, 34); font-family: 'Yanone Kaffeesatz'; font-weight: bold;">"filename" LIKE 'mobile/Library/Mail/%</span><span style="font-family: 'Yanone Kaffeesatz'; color: rgb(34, 34, 34); font-size: 18px; font-weight: bold;">’</span></div><div><br/></div><div><span style="font-family: 'Yanone Kaffeesatz'; color: rgb(34, 34, 34); font-size: 18px; font-weight: bold;">暂无</span></div><hr/><div><br/></div><div style="padding: 0px; color: rgb(70, 79, 85); font-size: 16px; word-break: break-all; font-family: Helvetica, 'Hiragino Sans GB', 'Microsoft Yahei', 微软雅黑, serif; font-variant-caps: normal; letter-spacing: normal; text-transform: none; white-space: normal; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-indent: 2em; text-align: left; -en-paragraph: true; margin-top: 1em; margin-bottom: 1em;"><span style="padding: 0px; color: rgb(70, 79, 85); font-size: 14px; word-break: break-all; font-family: 微软雅黑, 'Microsoft YaHei'; font-variant-caps: normal; letter-spacing: normal; text-transform: none; white-space: normal; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-indent: 2em; -en-paragraph: true; margin-top: 1em; margin-bottom: 1em; orphans: auto; widows: auto;">使用FSEvents来删除OS X中的恶意软件</span></div><div style="padding: 0px; color: rgb(70, 79, 85); font-size: 16px; word-break: break-all; font-family: Helvetica, 'Hiragino Sans GB', 'Microsoft Yahei', 微软雅黑, serif; font-variant-caps: normal; letter-spacing: normal; text-transform: none; white-space: normal; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-indent: 2em; text-align: left; -en-paragraph: true; margin-top: 1em; margin-bottom: 1em;"><span style="padding: 0px; color: rgb(70, 79, 85); font-size: 14px; word-break: break-all; font-family: 微软雅黑, 'Microsoft YaHei'; font-variant-caps: normal; letter-spacing: normal; text-transform: none; white-space: normal; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-indent: 2em; -en-paragraph: true; margin-top: 1em; margin-bottom: 1em; orphans: auto; widows: auto;">比如说，我们可以使用FSEventsparser来识别类似OS X/Iworm这样的恶意软件。Iworm是OS X平台下的一款木马，计算机在感染了这一木马之后，攻击者就可以利用社交媒体网站来获取到目标用户的IP地址，然后将这台目标主机与僵尸网络进行连接。</span></div><div style="padding: 0px; color: rgb(70, 79, 85); font-size: 16px; word-break: break-all; font-family: Helvetica, 'Hiragino Sans GB', 'Microsoft Yahei', 微软雅黑, serif; font-variant-caps: normal; letter-spacing: normal; text-transform: none; white-space: normal; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-indent: 2em; text-align: left; -en-paragraph: true; margin-top: 1em; margin-bottom: 1em;"><span style="padding: 0px; color: rgb(70, 79, 85); font-size: 14px; word-break: break-all; font-family: 微软雅黑, 'Microsoft YaHei'; font-variant-caps: normal; letter-spacing: normal; text-transform: none; white-space: normal; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-indent: 2em; -en-paragraph: true; margin-top: 1em; margin-bottom: 1em; orphans: auto; widows: auto;">安全研究人员让虚拟机系统感染了Iworm，然后运行FSEventsParser。根据恶意软件的运行机制，它们通常会使用守护进程来作为启动选择。所以我们利用FSEventsParser来对/System/Library/LaunchDaemons/ 和/Library/LaunchDaemons这两个目录进行监视。在扫描之后我们发现，2016年2月1日系统创建了一个文件（/Library/LaunchDaemons/com.JawaW.plist）。在对数据进行了过滤处理之后，我们得到的事件标识符为“ItemCreated”，“ ItemModified”，以及“ItemIsfile”。除此之外，系统在当日还创建了一个新文件夹（/Library/Application Support/JavaW）。</span></div><div style="padding: 0px; color: rgb(70, 79, 85); font-size: 16px; word-break: break-all; font-family: Helvetica, 'Hiragino Sans GB', 'Microsoft Yahei', 微软雅黑, serif; font-variant-caps: normal; letter-spacing: normal; text-indent: 0px; text-transform: none; white-space: normal; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: center; -en-paragraph: true; margin-top: 1em; margin-bottom: 1em;"><a href="http://p9.qhimg.com/t012d267892a6263f5d.png"><img src="%E7%9C%8B%E9%9B%AA%E5%85%AB%E6%9C%88%E9%AA%8C%E8%AF%81.resources/45F83C6E-60B4-42E5-B19F-DE02973353AF.png" height="67" width="576"/><br/></a><br/></div><div style="padding: 0px; color: rgb(70, 79, 85); font-size: 16px; word-break: break-all; font-family: Helvetica, 'Hiragino Sans GB', 'Microsoft Yahei', 微软雅黑, serif; font-variant-caps: normal; letter-spacing: normal; text-transform: none; white-space: normal; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-indent: 2em; text-align: left; -en-paragraph: true; margin-top: 1em; margin-bottom: 1em;"><span style="padding: 0px; color: rgb(70, 79, 85); font-size: 14px; word-break: break-all; font-family: 微软雅黑, 'Microsoft YaHei'; font-variant-caps: normal; letter-spacing: normal; text-transform: none; white-space: normal; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-indent: 2em; -en-paragraph: true; margin-top: 1em; margin-bottom: 1em; orphans: auto; widows: auto;">现在，我们已经获取到了恶意文件的创建时间和存储位置。那么接下来我们就可以利用这一工具来对被入侵的系统进行更深入地分析了</span></div><div><a href="http://www.freebuf.com/articles/system/108732.html">http://www.freebuf.com/articles/system/108732.html</a></div><div><br/></div><div><span style="color: rgb(88, 88, 88); font-family: 微软雅黑; font-size: 16px; font-variant-caps: normal; letter-spacing: normal; text-indent: 0px; text-transform: none; white-space: normal; word-spacing: 0px; -webkit-text-stroke-width: 0px; float: none;">.zip压缩文件中包含有可执行的 Mach-O 文件，这些文件看似是.txt或.jpg文件，但其实在这些文件后缀名后被加了个空格隐藏在末尾，这就是木马程序的伪装手段。</span></div><div><br/></div><div><span style="font-family: 微软雅黑; color: rgb(88, 88, 88); font-size: 16px;">实测10.12.6不行</span></div><div><span style="font-family: 微软雅黑; color: rgb(88, 88, 88); font-size: 16px;">匿名unix executable文件也执行不了。改名之后可以允许执行。</span></div><div><span style="font-family: 微软雅黑; color: rgb(88, 88, 88); font-size: 16px;">todo：</span></div><div><a href="http://blog.csdn.net/b719426297/article/details/45045715">http://blog.csdn.net/b719426297/article/details/45045715</a></div><div><a href="http://www.grivet-tools.com/blog/2014/launchdaemons-vs-launchagents/">http://www.grivet-tools.com/blog/2014/launchdaemons-vs-launchagents/</a></div><div><a href="https://www.welivesecurity.com/2016/08/30/osxkeydnap-spreads-via-signed-transmission-application/">https://www.welivesecurity.com/2016/08/30/osxkeydnap-spreads-via-signed-transmission-application/</a></div><div><br/></div><div><img src="%E7%9C%8B%E9%9B%AA%E5%85%AB%E6%9C%88%E9%AA%8C%E8%AF%81.resources/713CD422-154A-402B-906A-CAC371C0F762.png" height="636" width="994"/><br/></div><div><br/></div><div>安装homebrew</div><div>安装upx  安装xcode</div><div><a href="http://blog.csdn.net/langzi7758521/article/details/53079307">http://blog.csdn.net/langzi7758521/article/details/53079307</a></div><div><br/></div><div><img src="%E7%9C%8B%E9%9B%AA%E5%85%AB%E6%9C%88%E9%AA%8C%E8%AF%81.resources/4E0362D5-B46B-467B-A7E2-363F4891C605.png" height="776" width="1128"/><br/></div><div><br/></div><div><img src="%E7%9C%8B%E9%9B%AA%E5%85%AB%E6%9C%88%E9%AA%8C%E8%AF%81.resources/CC70CFB8-FE33-4D58-8A9B-A372869CC286.png" height="256" width="980"/><br/></div><div><br/></div><div><br/></div><div><img src="%E7%9C%8B%E9%9B%AA%E5%85%AB%E6%9C%88%E9%AA%8C%E8%AF%81.resources/EC6C0E94-FB7E-480E-91B2-E29DFB1EEC92.png" height="806" width="1134"/><br/></div><div><br/></div><div><br/></div><div><span style="font-style: italic; box-sizing: border-box; color: rgb(188, 96, 96); font-family: Menlo, Monaco, Consolas, 'Courier New', monospace; font-size: 13px; font-variant-caps: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: auto; word-spacing: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px; background-color: rgb(243, 243, 243);">/Library/LaunchAgents/</span><span style="font-style: italic; box-sizing: border-box; color: rgb(68, 68, 68); font-family: Menlo, Monaco, Consolas, 'Courier New', monospace; font-size: 13px; font-variant-caps: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: auto; word-spacing: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px; background-color: rgb(243, 243, 243);"> </span></div><div><br/></div><div><span style="font-family: Menlo, Monaco, Consolas, 'Courier New', monospace; color: rgb(68, 68, 68); font-size: 13px; white-space: pre-wrap; background-color: rgb(243, 243, 243); font-style: italic;">没有</span></div><div><br/></div><div><span style="font-style: italic; box-sizing: border-box; color: inherit; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace; font-size: inherit; font-variant-caps: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: auto; word-spacing: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px; background-color: rgb(243, 243, 243); padding: 0px; border-top-left-radius: 0px; border-top-right-radius: 0px; border-bottom-right-radius: 0px; border-bottom-left-radius: 0px;">/$USER/Library/LaunchAgents/</span></div><div><span style="font-style: italic; box-sizing: border-box; border: 0px; font-family: 'Open Sans', sans-serif; font-size: 16px; outline: 0px; padding: 0px; color: rgb(64, 64, 64); font-variant-caps: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px;">~/Library/LaunchAgents/</span></div><div><br/></div><div><span style="font-family: Menlo, Monaco, Consolas, 'Courier New', monospace; white-space: pre-wrap; background-color: rgb(243, 243, 243); font-style: italic;">没有</span></div><div><br/></div><div><span style="font-style: italic; box-sizing: border-box; border: 0px; font-family: 'Open Sans', sans-serif; font-size: 16px; outline: 0px; padding: 0px; color: rgb(64, 64, 64); font-variant-caps: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px;">/System/Library/LaunchAgents/</span><span style="color: rgb(64, 64, 64); font-family: 'Open Sans', sans-serif; font-size: 16px; font-variant-caps: normal; letter-spacing: normal; text-indent: 0px; text-transform: none; white-space: normal; word-spacing: 0px; -webkit-text-stroke-width: 0px; float: none;"> </span></div><div><br/></div><div><span style="font-family: 'Open Sans', sans-serif; color: rgb(64, 64, 64); font-size: 16px;">没有</span></div><div><br/></div><div>查不到</div><div><br/></div><div><img src="%E7%9C%8B%E9%9B%AA%E5%85%AB%E6%9C%88%E9%AA%8C%E8%AF%81.resources/AC70D5F7-E57A-47E1-A8A0-40FB3A7D1166.png" height="1092" width="1378"/><br/></div><div><br/></div><hr/><div><br/>osx 10.9</div><div><br/></div><h3 style="box-sizing: border-box; font-family: 微软雅黑; font-weight: bold; color: rgb(0, 112, 192); font-size: 16px; font-variant-caps: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px;"><span style="box-sizing: border-box; font-family: 微软雅黑; font-weight: bold; color: rgb(0, 112, 192); font-size: 14pt; font-variant-caps: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px;">代码混淆：</span></h3><div><br/></div><div><img src="%E7%9C%8B%E9%9B%AA%E5%85%AB%E6%9C%88%E9%AA%8C%E8%AF%81.resources/514155B2-CFBA-4EF4-97E3-C6078FB934F9.png" height="770" width="990"/><br/></div><div><br/></div><div>xpu -d backdoor</div><div><br/></div><div><img src="%E7%9C%8B%E9%9B%AA%E5%85%AB%E6%9C%88%E9%AA%8C%E8%AF%81.resources/A813F5A0-3AB2-4448-BFC7-DD9456BD8644.png" height="772" width="994"/><br/></div><div><br/></div><div><span style="font-style: italic; box-sizing: border-box; border: 0px; font-family: 'Open Sans', sans-serif; font-size: 16px; outline: 0px; padding: 0px; color: rgb(64, 64, 64); font-variant-caps: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px;"><br/></span></div><h3 style="box-sizing: border-box; font-family: 微软雅黑; font-weight: bold; color: rgb(0, 112, 192); font-size: 16px; font-variant-caps: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px;"><span style="box-sizing: border-box; font-family: 微软雅黑; font-weight: bold; color: rgb(0, 112, 192); font-size: 16px; font-variant-caps: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px;">木马持续性：</span></h3><div><br/></div><div><span style="font-style: italic; box-sizing: border-box; border: 0px; font-family: 'Open Sans', sans-serif; font-size: 16px; outline: 0px; padding: 0px; color: rgb(64, 64, 64); font-variant-caps: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px;">~/Library/LaunchAgents/</span></div><div><br/></div><div><img src="%E7%9C%8B%E9%9B%AA%E5%85%AB%E6%9C%88%E9%AA%8C%E8%AF%81.resources/DBFB55A5-9CA4-4783-8B23-02C5C5BD0CD2.png" height="682" width="1014"/><br/></div><div><br/></div><div><br/></div><div><br/></div><div><span style="box-sizing: border-box; font-size: 15px; word-wrap: break-word; word-break: break-word; color: rgb(88, 88, 88); font-family: 微软雅黑; font-variant-caps: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px;">被用来保存icloudsyncd 执行文件，该目录中包含有恶意软件的进程ID </span><a style="box-sizing: border-box; font-size: 15px; word-wrap: break-word; word-break: break-word; color: rgb(88, 88, 88); font-family: 微软雅黑; font-variant-caps: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px;">process.id和构造名字（攻击者所起）信息build.id</a><span style="box-sizing: border-box; font-size: 15px; word-wrap: break-word; word-break: break-word; color: rgb(88, 88, 88); font-family: 微软雅黑; font-variant-caps: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px;"> </span></div><div><span style="box-sizing: border-box; font-size: 15px; word-wrap: break-word; word-break: break-word; color: rgb(88, 88, 88); font-family: 微软雅黑; font-variant-caps: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px;">利用管理者权限，木马程序通过更改icloudsyncd文件的所有者权限为root:admin，并更改可执行</span><span style="box-sizing: border-box; font-size: 15px; word-wrap: break-word; word-break: break-word; color: rgb(88, 88, 88); font-family: 微软雅黑; font-variant-caps: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px;">文件的</span><span style="box-sizing: border-box; font-size: 15px; word-wrap: break-word; word-break: break-word; color: rgb(88, 88, 88); font-family: 微软雅黑; font-variant-caps: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px;">setuid</span><span style="box-sizing: border-box; font-size: 15px; word-wrap: break-word; word-break: break-word; color: rgb(88, 88, 88); font-family: 微软雅黑; font-variant-caps: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px;">和</span><span style="box-sizing: border-box; font-size: 15px; word-wrap: break-word; word-break: break-word; color: rgb(88, 88, 88); font-family: 微软雅黑; font-variant-caps: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px;">setgid</span><span style="box-sizing: border-box; font-size: 15px; word-wrap: break-word; word-break: break-word; color: rgb(88, 88, 88); font-family: 微软雅黑; font-variant-caps: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px;"> </span><span style="box-sizing: border-box; font-size: 15px; word-wrap: break-word; word-break: break-word; color: rgb(88, 88, 88); font-family: 微软雅黑; font-variant-caps: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px;">，这意味着木马后续将以</span><span style="box-sizing: border-box; font-size: 15px; word-wrap: break-word; word-break: break-word; color: rgb(88, 88, 88); font-family: 微软雅黑; font-variant-caps: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px;">root</span><span style="box-sizing: border-box; font-size: 15px; word-wrap: break-word; word-break: break-word; color: rgb(88, 88, 88); font-family: 微软雅黑; font-variant-caps: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px;">权限运行于系统中。</span></div><div><img src="%E7%9C%8B%E9%9B%AA%E5%85%AB%E6%9C%88%E9%AA%8C%E8%AF%81.resources/AB322B3E-BAB0-4FA9-A527-2E43FB032370.png" height="668" width="1026"/><br/></div><div><br/></div><div><img src="%E7%9C%8B%E9%9B%AA%E5%85%AB%E6%9C%88%E9%AA%8C%E8%AF%81.resources/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202017-08-17%20%E4%B8%8A%E5%8D%8812.13.40.png" height="116" width="1028"/><br/></div><div><br/></div><div><img src="%E7%9C%8B%E9%9B%AA%E5%85%AB%E6%9C%88%E9%AA%8C%E8%AF%81.resources/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202017-08-17%20%E4%B8%8A%E5%8D%8812.22.26.png" height="182" width="922"/><br/></div><div><br/></div><div><img src="%E7%9C%8B%E9%9B%AA%E5%85%AB%E6%9C%88%E9%AA%8C%E8%AF%81.resources/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202017-08-17%20%E4%B8%8A%E5%8D%8812.23.48.png" height="610" width="1034"/><br/></div><div><br/></div><div><img src="%E7%9C%8B%E9%9B%AA%E5%85%AB%E6%9C%88%E9%AA%8C%E8%AF%81.resources/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202017-08-17%20%E4%B8%8A%E5%8D%8812.27.15.png" height="102" width="1020"/><br/></div><div><br/></div><div><span style="box-sizing: border-box; font-family: 微软雅黑; font-weight: bold; color: rgb(0, 112, 192); font-size: 16px; font-variant-caps: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px;">窃取密码管理器Keychain信息：</span></div><div style="box-sizing: border-box; font-family: 微软雅黑; font-weight: bold; color: rgb(0, 112, 192); font-size: 16px; font-variant-caps: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px;"><br/></div><div><img src="%E7%9C%8B%E9%9B%AA%E5%85%AB%E6%9C%88%E9%AA%8C%E8%AF%81.resources/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202017-08-17%20%E4%B8%8A%E5%8D%8812.38.27.png" height="392" width="1038"/><br/></div><div><br/></div><h3 style="box-sizing: border-box; font-family: 微软雅黑; font-weight: bold; color: rgb(0, 112, 192); font-size: 16px; font-variant-caps: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px;"><span style="box-sizing: border-box; font-family: 微软雅黑; font-weight: bold; color: rgb(0, 112, 192); font-size: 16px; font-variant-caps: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px;">与C&amp;C控制服务器的通信：</span></h3><div><a href="https://onion.to">https://onion.to</a></div><div><br/></div><div><a href="http://duskgytldkxiuqc6.onion/">http://duskgytldkxiuqc6.onion/</a></div><div><br/></div><div><span style="font-style: italic; color: rgb(204, 0, 0); font-family: arial; font-size: 13px; font-variant-caps: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px;">远程</span><span style="color: rgb(51, 51, 51); font-family: arial; font-size: 13px; font-variant-caps: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); float: none;">命令和控制</span><span style="font-style: italic; color: rgb(204, 0, 0); font-family: arial; font-size: 13px; font-variant-caps: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px;">服务器</span><span style="color: rgb(51, 51, 51); font-family: arial; font-size: 13px; font-variant-caps: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); float: none;">(</span><span style="font-style: italic; color: rgb(204, 0, 0); font-family: arial; font-size: 13px; font-variant-caps: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px;">C&amp;C</span><span style="color: rgb(51, 51, 51); font-family: arial; font-size: 13px; font-variant-caps: normal; letter-spacing: normal; text-indent: 0px; text-transform: none; white-space: normal; word-spacing: 0px; -webkit-text-stroke-width: 0px; float: none;"> server</span></div><div><br/></div><hr/><div><a style="color: rgb(91, 91, 91); font-family: 微软雅黑; font-size: 12px; font-variant-caps: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: auto; word-spacing: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px; background-color: rgb(246, 246, 246); float: none;" href="https://www.symantec.com/security_response/writeup.jsp?docid=2016-070706-5326-99&amp;tabid=3">https://www.symantec.com/security_response/writeup.jsp?docid=2016-070706-5326-99&amp;tabid=3</a><br/><br/><br/><div style=" padding: 0px; color: rgb(68, 68, 68); font-family: arial, helvetica, sans-serif; font-size: 12px; font-style: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">OSX.Keydnap is a Trojan horse for Mac OS X computers that opens a back door on the compromised computer. It may also steal information and download potentially malicious files. <br/><br/>
</div><div><h3 style=" padding: 0px; color: rgb(68, 68, 68); font-weight: bold; font-size: 14px; font-family: arial, helvetica, sans-serif; font-style: normal; font-variant-caps: normal; letter-spacing: normal; orphans: auto; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">Antivirus Protection Dates
</h3><ul style=" padding: 0px; list-style: none; color: rgb(68, 68, 68); font-family: arial, helvetica, sans-serif; font-size: 12px; font-style: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);"><li style=" padding: 0px 0px 0px 10px; list-style-position: outside; list-style-type: none; background-image: url(https://www.symantec.com/images/version-3/bullets/circleGray.png); background-position: 0px 0.5em; background-repeat: no-repeat no-repeat;"><strong style="font-style: normal; font-weight: bold;">Initial Rapid Release version </strong>July 7, 2016 revision 002</li><li style=" padding: 0px 0px 0px 10px; list-style-position: outside; list-style-type: none; background-image: url(https://www.symantec.com/images/version-3/bullets/circleGray.png); background-position: 0px 0.5em; background-repeat: no-repeat no-repeat;"><strong style="font-style: normal; font-weight: bold;">Latest Rapid Release version </strong>September 22, 2016 revision 004</li><li style=" padding: 0px 0px 0px 10px; list-style-position: outside; list-style-type: none; background-image: url(https://www.symantec.com/images/version-3/bullets/circleGray.png); background-position: 0px 0.5em; background-repeat: no-repeat no-repeat;"><strong style="font-style: normal; font-weight: bold;">Initial Daily Certified version </strong>July 7, 2016 revision 006</li><li style=" padding: 0px 0px 0px 10px; list-style-position: outside; list-style-type: none; background-image: url(https://www.symantec.com/images/version-3/bullets/circleGray.png); background-position: 0px 0.5em; background-repeat: no-repeat no-repeat;"><strong style="font-style: normal; font-weight: bold;">Latest Daily Certified version </strong>September 22, 2016 revision 025</li><li style=" padding: 0px 0px 0px 10px; list-style-position: outside; list-style-type: none; background-image: url(https://www.symantec.com/images/version-3/bullets/circleGray.png); background-position: 0px 0.5em; background-repeat: no-repeat no-repeat;"><strong style="font-style: normal; font-weight: bold;">Initial Weekly Certified release date </strong>July 13, 2016</li></ul></div><div style=" padding: 0px; color: rgb(68, 68, 68); font-family: arial, helvetica, sans-serif; font-size: 12px; font-style: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">Click <a style="color: rgb(114, 168, 38); text-decoration: none; padding-right: 12px; background-image: url(https://www.symantec.com/images/version-3/icons/popup-icon.png); zoom: 1; background-position: 100% 50%; background-repeat: no-repeat no-repeat;" href="https://www.symantec.com/security_response/writeup.jsp?docid=2016-070706-5326-99#">here</a> for a more detailed description of Rapid Release and Daily Certified virus definitions.
</div><br/><br/><h1 style=" padding: 0px; color: rgb(68, 68, 68); font-weight: bold; font-size: 24px; font-family: arial, helvetica, sans-serif; font-style: normal; font-variant-caps: normal; letter-spacing: normal; orphans: auto; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px;">Removal</h1><br/><span style="color: rgb(68, 68, 68); font-family: arial, helvetica, sans-serif; font-size: 12px; font-style: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); float: none;">The following instructions pertain to all current and recent Symantec antivirus products for Macintosh. </span></div><div><div><ol style=" padding: 0px; color: rgb(68, 68, 68); font-family: arial, helvetica, sans-serif; font-size: 12px; font-style: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><li style=" padding: 0px 0px 0px 10px; list-style-position: outside; list-style-type: none; background-image: url(https://www.symantec.com/images/version-3/bullets/circleGray.png); background-position: 0px 0.5em; background-repeat: no-repeat no-repeat;">Update the virus definitions.</li><li style=" padding: 0px 0px 0px 10px; list-style-position: outside; list-style-type: none; background-image: url(https://www.symantec.com/images/version-3/bullets/circleGray.png); background-position: 0px 0.5em; background-repeat: no-repeat no-repeat;">Run a full system scan and repair or delete all the files detected. <br/></li></ol><span style="color: rgb(68, 68, 68); font-family: arial, helvetica, sans-serif; font-size: 12px; font-style: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); float: none;">For specific details on each of these steps, read the following instructions. </span></div><div><br style="color: rgb(68, 68, 68); font-family: arial, helvetica, sans-serif; font-size: 12px; font-style: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px;"/><br/></div><div><strong style="font-style: normal; font-weight: bold; color: rgb(68, 68, 68); font-family: arial, helvetica, sans-serif; font-size: 12px; font-variant-caps: normal; letter-spacing: normal; orphans: auto; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px;">1. To update the virus definitions</strong><span style="color: rgb(68, 68, 68); font-family: arial, helvetica, sans-serif; font-size: 12px; font-style: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); float: none;"> </span></div><div><span style="color: rgb(68, 68, 68); font-family: arial, helvetica, sans-serif; font-size: 12px; font-style: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); float: none;">To obtain the most recent virus definitions run LiveUpdate: These virus definitions are posted to the LiveUpdate servers regularly. To determine whether definitions for this threat are available by LiveUpdate, refer to the </span><a style="color: rgb(114, 168, 38); text-decoration: none; font-family: arial, helvetica, sans-serif; font-size: 12px; font-style: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px;" href="https://www.symantec.com/security_response/definitions.jsp?pid=sep_mac_12">Virus Definitions (LiveUpdate)</a><span style="color: rgb(68, 68, 68); font-family: arial, helvetica, sans-serif; font-size: 12px; font-style: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); float: none;">. </span></div><div><br style="color: rgb(68, 68, 68); font-family: arial, helvetica, sans-serif; font-size: 12px; font-style: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px;"/><br/></div><div><strong style="font-style: normal; font-weight: bold; color: rgb(68, 68, 68); font-family: arial, helvetica, sans-serif; font-size: 12px; font-variant-caps: normal; letter-spacing: normal; orphans: auto; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px;">2. To scan for and delete the infected files</strong><span style="color: rgb(68, 68, 68); font-family: arial, helvetica, sans-serif; font-size: 12px; font-style: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); float: none;"> </span></div></div><div><ul style=" padding: 0px; list-style: none; color: rgb(68, 68, 68); font-family: arial, helvetica, sans-serif; font-size: 12px; font-style: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><li style=" padding: 0px 0px 0px 10px; list-style-position: outside; list-style-type: none; background-image: url(https://www.symantec.com/images/version-3/bullets/circleGray.png); background-position: 0px 0.5em; background-repeat: no-repeat no-repeat;">Start your Norton AntiVirus or Symantec Endpoint Protection for Macintosh program and make sure that it is configured to scan all files. </li><li style=" padding: 0px 0px 0px 10px; list-style-position: outside; list-style-type: none; background-image: url(https://www.symantec.com/images/version-3/bullets/circleGray.png); background-position: 0px 0.5em; background-repeat: no-repeat no-repeat;">Run a full system scan.</li><li style=" padding: 0px 0px 0px 10px; list-style-position: outside; list-style-type: none; background-image: url(https://www.symantec.com/images/version-3/bullets/circleGray.png); background-position: 0px 0.5em; background-repeat: no-repeat no-repeat;">If any files are detected, click Repair (if available) or Delete.</li></ul><br/><br/></div><div>Technical Detail</div><div><br/></div><div><div style=" padding: 0px; color: rgb(68, 68, 68); font-family: arial, helvetica, sans-serif; font-size: 12px; font-style: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">Once executed, the Trojan creates the following files: <ul style=" padding: 0px; list-style: none;"><li style=" padding: 0px 0px 0px 10px; list-style-position: outside; list-style-type: none; background-image: url(https://www.symantec.com/images/version-3/bullets/circleGray.png); background-position: 0px 0.5em; background-repeat: no-repeat no-repeat;">/Library/LaunchAgents/[PLIST FILE]</li><li style=" padding: 0px 0px 0px 10px; list-style-position: outside; list-style-type: none; background-image: url(https://www.symantec.com/images/version-3/bullets/circleGray.png); background-position: 0px 0.5em; background-repeat: no-repeat no-repeat;">$HOME/Library/LaunchAgents/[PLIST FILE]</li></ul><br/><strong style="font-style: normal; font-weight: bold;">Note:</strong> Where [PLIST FILE] is a .plist (Property List) file created by the Trojan in order to execute itself.  <br/><br/>Next, the Trojan opens a back door on the compromised computer and connects to the following remote location: <ul style=" padding: 0px; list-style: none;"><li style=" padding: 0px 0px 0px 10px; list-style-position: outside; list-style-type: none; background-image: url(https://www.symantec.com/images/version-3/bullets/circleGray.png); background-position: 0px 0.5em; background-repeat: no-repeat no-repeat;">[https://]g5wcesdfjzne7255.<a href="http://onion.to">onion.to</a></li></ul><br/>The Trojan may then perform the following actions: <ul style=" padding: 0px; list-style: none;"><li style=" padding: 0px 0px 0px 10px; list-style-position: outside; list-style-type: none; background-image: url(https://www.symantec.com/images/version-3/bullets/circleGray.png); background-position: 0px 0.5em; background-repeat: no-repeat no-repeat;">Download and upload files</li><li style=" padding: 0px 0px 0px 10px; list-style-position: outside; list-style-type: none; background-image: url(https://www.symantec.com/images/version-3/bullets/circleGray.png); background-position: 0px 0.5em; background-repeat: no-repeat no-repeat;">Create processes</li><li style=" padding: 0px 0px 0px 10px; list-style-position: outside; list-style-type: none; background-image: url(https://www.symantec.com/images/version-3/bullets/circleGray.png); background-position: 0px 0.5em; background-repeat: no-repeat no-repeat;">Update itself</li><li style=" padding: 0px 0px 0px 10px; list-style-position: outside; list-style-type: none; background-image: url(https://www.symantec.com/images/version-3/bullets/circleGray.png); background-position: 0px 0.5em; background-repeat: no-repeat no-repeat;">Steal user credentials</li></ul><br/>The Trojan may then send the stolen information to the remote location.
</div><div><h3 style=" padding: 0px; color: rgb(68, 68, 68); font-weight: bold; font-size: 14px; font-family: arial, helvetica, sans-serif; font-style: normal; font-variant-caps: normal; letter-spacing: normal; orphans: auto; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">Recommendations
</h3><p style=" padding: 0px; color: rgb(68, 68, 68); font-family: arial, helvetica, sans-serif; font-size: 12px; font-style: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">Symantec Security Response encourages all users and administrators to adhere to the following basic security "best practices":
</p></div><ul style=" padding: 0px; list-style: none; color: rgb(68, 68, 68); font-family: arial, helvetica, sans-serif; font-size: 12px; font-style: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);"><li style=" padding: 0px 0px 0px 10px; list-style-position: outside; list-style-type: none; background-image: url(https://www.symantec.com/images/version-3/bullets/circleGray.png); background-position: 0px 0.5em; background-repeat: no-repeat no-repeat;">Use a firewall to block all incoming connections from the Internet to services that should not be publicly available. By default, you should deny all incoming connections and only allow services you explicitly want to offer to the outside world.</li><li style=" padding: 0px 0px 0px 10px; list-style-position: outside; list-style-type: none; background-image: url(https://www.symantec.com/images/version-3/bullets/circleGray.png); background-position: 0px 0.5em; background-repeat: no-repeat no-repeat;">Enforce a password policy. Complex passwords make it difficult to crack password files on compromised computers. This helps to prevent or limit damage when a computer is compromised.</li><li style=" padding: 0px 0px 0px 10px; list-style-position: outside; list-style-type: none; background-image: url(https://www.symantec.com/images/version-3/bullets/circleGray.png); background-position: 0px 0.5em; background-repeat: no-repeat no-repeat;">Ensure that programs and users of the computer use the lowest level of privileges necessary to complete a task. When prompted for a root or UAC password, ensure that the program asking for administration-level access is a legitimate application. </li><li style=" padding: 0px 0px 0px 10px; list-style-position: outside; list-style-type: none; background-image: url(https://www.symantec.com/images/version-3/bullets/circleGray.png); background-position: 0px 0.5em; background-repeat: no-repeat no-repeat;">Disable AutoPlay to prevent the automatic launching of executable files on network and removable drives, and disconnect the drives when not required. If write access is not required, enable read-only mode if the option is available.</li><li style=" padding: 0px 0px 0px 10px; list-style-position: outside; list-style-type: none; background-image: url(https://www.symantec.com/images/version-3/bullets/circleGray.png); background-position: 0px 0.5em; background-repeat: no-repeat no-repeat;">Turn off file sharing if not needed. If file sharing is required, use ACLs and password protection to limit access. Disable anonymous access to shared folders. Grant access only to user accounts with strong passwords to folders that must be shared. </li><li style=" padding: 0px 0px 0px 10px; list-style-position: outside; list-style-type: none; background-image: url(https://www.symantec.com/images/version-3/bullets/circleGray.png); background-position: 0px 0.5em; background-repeat: no-repeat no-repeat;">Turn off and remove unnecessary services. By default, many operating systems install auxiliary services that are not critical. These services are avenues of attack. If they are removed, threats have less avenues of attack.</li><li style=" padding: 0px 0px 0px 10px; list-style-position: outside; list-style-type: none; background-image: url(https://www.symantec.com/images/version-3/bullets/circleGray.png); background-position: 0px 0.5em; background-repeat: no-repeat no-repeat;">If a threat exploits one or more network services, disable, or block access to, those services until a patch is applied.</li><li style=" padding: 0px 0px 0px 10px; list-style-position: outside; list-style-type: none; background-image: url(https://www.symantec.com/images/version-3/bullets/circleGray.png); background-position: 0px 0.5em; background-repeat: no-repeat no-repeat;">Always keep your patch levels up-to-date, especially on computers that host public services and are accessible through the firewall, such as HTTP, FTP, mail, and DNS services.</li><li style=" padding: 0px 0px 0px 10px; list-style-position: outside; list-style-type: none; background-image: url(https://www.symantec.com/images/version-3/bullets/circleGray.png); background-position: 0px 0.5em; background-repeat: no-repeat no-repeat;">Configure your email server to block or remove email that contains file attachments that are commonly used to spread threats, such as .vbs, .bat, .exe, .pif and .scr files.</li><li style=" padding: 0px 0px 0px 10px; list-style-position: outside; list-style-type: none; background-image: url(https://www.symantec.com/images/version-3/bullets/circleGray.png); background-position: 0px 0.5em; background-repeat: no-repeat no-repeat;">Isolate compromised computers quickly to prevent threats from spreading further. Perform a forensic analysis and restore the computers using trusted media.</li><li style=" padding: 0px 0px 0px 10px; list-style-position: outside; list-style-type: none; background-image: url(https://www.symantec.com/images/version-3/bullets/circleGray.png); background-position: 0px 0.5em; background-repeat: no-repeat no-repeat;">Train employees not to open attachments unless they are expecting them. Also, do not execute software that is downloaded from the Internet unless it has been scanned for viruses. Simply visiting a compromised Web site can cause infection if certain browser vulnerabilities are not patched.</li><li style=" padding: 0px 0px 0px 10px; list-style-position: outside; list-style-type: none; background-image: url(https://www.symantec.com/images/version-3/bullets/circleGray.png); background-position: 0px 0.5em; background-repeat: no-repeat no-repeat;">If Bluetooth is not required for mobile devices, it should be turned off. If you require its use, ensure that the device's visibility is set to "Hidden" so that it cannot be scanned by other Bluetooth devices. If device pairing must be used, ensure that all devices are set to "Unauthorized", requiring authorization for each connection request. Do not accept applications that are unsigned or sent from unknown sources.</li><li style=" padding: 0px 0px 0px 10px; list-style-position: outside; list-style-type: none; background-image: url(https://www.symantec.com/images/version-3/bullets/circleGray.png); background-position: 0px 0.5em; background-repeat: no-repeat no-repeat;">For further information on the terms used in this document, please refer to the <a style="color: rgb(114, 168, 38); text-decoration: none;" href="http://www.symantec.com/business/security_response/glossary.jsp">Security Response glossary</a>.</li></ul><br/></div><div><br/></div><div><hr/><br/></div><div>工具</div><div>计算器</div><div>ihex</div><div>SQLite Professional</div><div>Microsoft Excel</div><div>ifunbox</div><div><br/></div><hr/><div><br/></div><div>设备</div><div>mac</div><div>iPhone</div><div>移动硬盘</div><div><br/></div><div><br/></div><div><br/></div></body></html>